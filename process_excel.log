2026-02-11 15:25:37,022 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-11 15:25:38,401 - INFO - 正在讀取檔案: AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx
2026-02-11 15:25:38,458 - ERROR - 處理檔案 AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx 時發生錯誤: `Import openpyxl` failed.  Use pip or conda to install the openpyxl package.
Traceback (most recent call last):
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\compat\_optional.py", line 158, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Users\301002\AppData\Local\Programs\Python\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\src\process_excel_order.py", line 54, in process_excel_file
    df = pd.read_excel(filepath, header=3)
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\io\excel\_base.py", line 481, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1621, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 559, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\compat\_optional.py", line 161, in import_optional_dependency
    raise ImportError(msg) from err
ImportError: `Import openpyxl` failed.  Use pip or conda to install the openpyxl package.
2026-02-11 15:30:55,753 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-11 15:30:56,840 - INFO - 正在讀取檔案: AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx
2026-02-11 15:31:02,610 - ERROR - 處理檔案 AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx 時發生錯誤: NDFrame.fillna() got an unexpected keyword argument 'method'
Traceback (most recent call last):
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\src\process_excel_order.py", line 70, in process_excel_file
    df['分提單號碼'] = df['分提單號碼'].fillna(method='ffill')
                       ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
TypeError: NDFrame.fillna() got an unexpected keyword argument 'method'
2026-02-11 15:37:20,960 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-11 15:37:21,493 - INFO - 正在讀取檔案: AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx
2026-02-11 15:37:25,188 - INFO - 解析完成，準備匯入 2562 筆資料...
2026-02-11 15:37:25,660 - INFO - 成功寫入資料庫！
2026-02-11 15:37:25,679 - INFO - 檔案已移至 processed 資料夾
2026-02-14 09:45:29,756 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-14 09:45:30,468 - INFO - 從 A1 讀取到主提單號: IPC251122404EX
2026-02-14 09:45:30,472 - INFO - 正在讀取檔案內容: IPC251122404EX清关资料1147件.xlsx
2026-02-14 09:45:31,223 - ERROR - 檔案格式錯誤，缺少欄位: ['分提單號碼', '貨物編號', '货物名称', '數量', '單價金額', '發票總金額']
2026-02-14 10:06:47,512 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-14 10:06:48,142 - WARNING - 警告: 檔案 IPC250426401EX清关数据-龙海960件7990.64KG（速龙派件） (1).xlsx 的 A1 欄位為空，無法取得主提單號(MAWB)。
2026-02-14 10:06:48,143 - INFO - 正在讀取檔案內容: IPC250426401EX清关数据-龙海960件7990.64KG（速龙派件） (1).xlsx
2026-02-14 10:06:49,098 - INFO - 解析完成，準備匯入 2479 筆資料...
2026-02-14 10:06:52,496 - INFO - 成功寫入資料庫！
2026-02-14 10:06:52,503 - INFO - 檔案已移至 processed 資料夾
2026-02-14 10:19:55,234 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-14 10:19:56,374 - WARNING - 警告: 檔案 IPC250426404EX-东莞955件 7630.03KG（速龙派件）.xlsx 的 A1 欄位為空，無法取得主提單號(MAWB)。
2026-02-14 10:19:56,375 - INFO - 正在讀取檔案內容: IPC250426404EX-东莞955件 7630.03KG（速龙派件）.xlsx
2026-02-14 10:19:58,210 - INFO - 解析完成，準備匯入 2460 筆資料...
2026-02-14 10:20:01,266 - INFO - 成功寫入資料庫！
2026-02-14 10:20:01,281 - INFO - 檔案已移至 processed 資料夾
2026-02-14 10:31:53,903 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-14 10:31:54,787 - INFO - 從 A1 讀取到主提單號: IPC250308421EX
2026-02-14 10:31:54,787 - INFO - 正在讀取檔案內容: IPC250308421EX清关数据-龙海1007件7358.78KG（速龙派件）.xlsx
2026-02-14 10:31:56,265 - INFO - 解析完成，準備匯入 2511 筆資料...
2026-02-14 10:31:59,695 - INFO - 成功寫入資料庫！
2026-02-14 10:31:59,705 - INFO - 檔案已移至 processed 資料夾
2026-02-14 10:37:28,815 - INFO - 掃描到 2 個檔案，開始作業...
2026-02-14 10:37:29,618 - INFO - 從 A1 讀取到主提單號: IPC250301421EX
2026-02-14 10:37:29,619 - INFO - 正在讀取檔案內容: IPC250301421EX清关数据-龙海929件7415.18KG（速龙派件）.xlsx
2026-02-14 10:37:30,789 - INFO - 解析完成，準備匯入 2258 筆資料...
2026-02-14 10:37:33,285 - INFO - 成功寫入資料庫！
2026-02-14 10:37:33,293 - INFO - 檔案已移至 processed 資料夾
2026-02-14 10:37:33,426 - INFO - 從 A1 讀取到主提單號: IPC250303410EX
2026-02-14 10:37:33,427 - INFO - 正在讀取檔案內容: IPC250303410EX清关数据-龙海905件7319.91KG（速龙派件）.xlsx
2026-02-14 10:37:34,427 - INFO - 解析完成，準備匯入 1869 筆資料...
2026-02-14 10:37:37,673 - INFO - 成功寫入資料庫！
2026-02-14 10:37:37,684 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:33:25,863 - INFO - 掃描到 13 個檔案，開始作業...
2026-02-14 22:33:26,635 - INFO - 從 A1 讀取到主提單號: IPC250329410EX
2026-02-14 22:33:26,636 - INFO - 正在讀取檔案內容: IPC250329410EX.xlsx
2026-02-14 22:33:27,754 - INFO - 解析完成，準備匯入 2767 筆資料...
2026-02-14 22:33:32,659 - INFO - 成功寫入資料庫！
2026-02-14 22:33:32,667 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:33:32,960 - INFO - 從 A1 讀取到主提單號: IPC250331405EX
2026-02-14 22:33:32,960 - INFO - 正在讀取檔案內容: IPC250331405EX.xlsx
2026-02-14 22:33:34,270 - INFO - 解析完成，準備匯入 2809 筆資料...
2026-02-14 22:33:39,182 - INFO - 成功寫入資料庫！
2026-02-14 22:33:39,189 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:33:39,499 - INFO - 從 A1 讀取到主提單號: IPC250331401EX
2026-02-14 22:33:39,500 - INFO - 正在讀取檔案內容: IPC250331401EX.xlsx
2026-02-14 22:33:40,960 - INFO - 解析完成，準備匯入 2210 筆資料...
2026-02-14 22:33:44,591 - INFO - 成功寫入資料庫！
2026-02-14 22:33:44,604 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:33:45,109 - INFO - 從 A1 讀取到主提單號: IPC250327403EX
2026-02-14 22:33:45,110 - INFO - 正在讀取檔案內容: IPC250327403EX.xlsx
2026-02-14 22:33:47,840 - INFO - 解析完成，準備匯入 3315 筆資料...
2026-02-14 22:33:54,293 - INFO - 成功寫入資料庫！
2026-02-14 22:33:54,303 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:33:54,608 - INFO - 從 A1 讀取到主提單號: IPC250329407EX
2026-02-14 22:33:54,610 - INFO - 正在讀取檔案內容: IPC250329407EX.xlsx
2026-02-14 22:33:56,398 - INFO - 解析完成，準備匯入 3007 筆資料...
2026-02-14 22:33:59,898 - INFO - 成功寫入資料庫！
2026-02-14 22:33:59,905 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:34:00,253 - INFO - 從 A1 讀取到主提單號: IPC250325423EX
2026-02-14 22:34:00,254 - INFO - 正在讀取檔案內容: IPC250325423EX.xlsx
2026-02-14 22:34:02,749 - INFO - 解析完成，準備匯入 2801 筆資料...
2026-02-14 22:34:05,670 - INFO - 成功寫入資料庫！
2026-02-14 22:34:05,681 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:34:05,954 - INFO - 從 A1 讀取到主提單號: IPC250325421EX
2026-02-14 22:34:05,955 - INFO - 正在讀取檔案內容: IPC250325421EX.xlsx
2026-02-14 22:34:07,327 - INFO - 解析完成，準備匯入 2447 筆資料...
2026-02-14 22:34:10,853 - INFO - 成功寫入資料庫！
2026-02-14 22:34:10,860 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:34:11,106 - INFO - 從 A1 讀取到主提單號: IPC250326720EX
2026-02-14 22:34:11,107 - INFO - 正在讀取檔案內容: IPC250326720EX.xlsx
2026-02-14 22:34:12,400 - INFO - 解析完成，準備匯入 2222 筆資料...
2026-02-14 22:34:16,202 - INFO - 成功寫入資料庫！
2026-02-14 22:34:16,221 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:34:16,592 - INFO - 從 A1 讀取到主提單號: IPC250326721EX
2026-02-14 22:34:16,594 - INFO - 正在讀取檔案內容: IPC250326721EX.xlsx
2026-02-14 22:34:18,843 - INFO - 解析完成，準備匯入 3003 筆資料...
2026-02-14 22:34:22,450 - INFO - 成功寫入資料庫！
2026-02-14 22:34:22,458 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:34:22,780 - INFO - 從 A1 讀取到主提單號: IPC250324412EX.
2026-02-14 22:34:22,780 - INFO - 正在讀取檔案內容: IPC250324412EX.xlsx
2026-02-14 22:34:24,152 - INFO - 解析完成，準備匯入 2299 筆資料...
2026-02-14 22:34:28,360 - INFO - 成功寫入資料庫！
2026-02-14 22:34:28,377 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:34:28,643 - INFO - 從 A1 讀取到主提單號: IPC250324413EX
2026-02-14 22:34:28,644 - INFO - 正在讀取檔案內容: IPC250324413EX.xlsx
2026-02-14 22:34:30,092 - INFO - 解析完成，準備匯入 2441 筆資料...
2026-02-14 22:34:34,230 - INFO - 成功寫入資料庫！
2026-02-14 22:34:34,250 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:34:34,592 - INFO - 從 A1 讀取到主提單號: IPC250322408EX
2026-02-14 22:34:34,592 - INFO - 正在讀取檔案內容: IPC250322408EX.xlsx
2026-02-14 22:34:36,067 - INFO - 解析完成，準備匯入 2743 筆資料...
2026-02-14 22:34:40,188 - INFO - 成功寫入資料庫！
2026-02-14 22:34:40,200 - INFO - 檔案已移至 processed 資料夾
2026-02-14 22:34:40,566 - INFO - 從 A1 讀取到主提單號: IPC250322412EX
2026-02-14 22:34:40,567 - INFO - 正在讀取檔案內容: IPC250322412EX.xlsx
2026-02-14 22:34:42,128 - INFO - 解析完成，準備匯入 2691 筆資料...
2026-02-14 22:34:46,187 - INFO - 成功寫入資料庫！
2026-02-14 22:34:46,195 - INFO - 檔案已移至 processed 資料夾
2026-02-14 23:38:06,297 - INFO - 掃描到 3 個檔案，開始作業...
2026-02-14 23:38:06,850 - INFO - 從 A1 讀取到主提單號: IPC250403408EX
2026-02-14 23:38:06,850 - INFO - 正在讀取檔案內容: IPC250403408EX.xlsx
2026-02-14 23:38:07,565 - INFO - 解析完成，準備匯入 2315 筆資料...
2026-02-14 23:38:11,973 - INFO - 成功寫入資料庫！
2026-02-14 23:38:11,995 - INFO - 檔案已移至 processed 資料夾
2026-02-14 23:38:12,173 - INFO - 從 A1 讀取到主提單號: IPC250403409EX
2026-02-14 23:38:12,173 - INFO - 正在讀取檔案內容: IPC250403409EX.xlsx
2026-02-14 23:38:13,156 - INFO - 解析完成，準備匯入 3040 筆資料...
2026-02-14 23:38:16,963 - INFO - 成功寫入資料庫！
2026-02-14 23:38:16,987 - INFO - 檔案已移至 processed 資料夾
2026-02-14 23:38:17,168 - INFO - 從 A1 讀取到主提單號: IPC250403407EX
2026-02-14 23:38:17,168 - INFO - 正在讀取檔案內容: IPC250403407EX.xlsx
2026-02-14 23:38:18,145 - INFO - 解析完成，準備匯入 2664 筆資料...
2026-02-14 23:38:21,860 - INFO - 成功寫入資料庫！
2026-02-14 23:38:21,873 - INFO - 檔案已移至 processed 資料夾
2026-02-15 12:03:01,732 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-15 12:03:02,510 - INFO - 檔案: 25040104EX.xlsx, MAWB: 25040104EX
2026-02-15 12:03:04,254 - INFO - 舊格式匹配失敗 (非舊格式特徵)，嘗試新格式...
2026-02-15 12:03:05,981 - INFO - 偵測為 [New Format]，解析出 8072 筆資料。
2026-02-15 12:03:09,257 - INFO - 成功寫入資料庫！
2026-02-15 12:03:09,286 - INFO - 檔案已移至 processed 資料夾
2026-02-15 12:15:55,314 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-15 12:15:55,844 - INFO - 從 A1 成功讀取主提單號 (MAWB): 主提單號碼:
2026-02-15 12:15:55,845 - INFO - 開始處理檔案: 25032401EX.xlsx, MAWB: 主提單號碼:
2026-02-15 12:15:56,951 - INFO - 舊格式匹配失敗 (非舊格式特徵)，嘗試新格式...
2026-02-15 12:15:58,123 - INFO - 偵測為 [New Format]，解析出 5440 筆資料。
2026-02-15 12:16:01,118 - INFO - 成功寫入資料庫！
2026-02-15 12:16:01,145 - INFO - 檔案已移至 processed 資料夾
2026-02-15 12:28:11,253 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-15 12:28:11,897 - INFO - A1 欄位內容 '主提單號碼:' 不符合純英數格式 (可能是中文標題)，將忽略 A1。
2026-02-15 12:28:11,898 - INFO - 使用檔名作為主提單號 (MAWB): 25032203EX
2026-02-15 12:28:11,898 - INFO - 開始處理檔案: 25032203EX.xlsx, MAWB: 25032203EX
2026-02-15 12:28:13,113 - INFO - 舊格式匹配失敗 (非舊格式特徵)，嘗試新格式...
2026-02-15 12:28:14,367 - INFO - 偵測為 [New Format]，解析出 5625 筆資料。
2026-02-15 12:28:18,070 - INFO - 成功寫入資料庫！
2026-02-15 12:28:18,077 - INFO - 檔案已移至 processed 資料夾
