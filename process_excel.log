2026-02-11 15:25:37,022 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-11 15:25:38,401 - INFO - 正在讀取檔案: AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx
2026-02-11 15:25:38,458 - ERROR - 處理檔案 AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx 時發生錯誤: `Import openpyxl` failed.  Use pip or conda to install the openpyxl package.
Traceback (most recent call last):
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\compat\_optional.py", line 158, in import_optional_dependency
    module = importlib.import_module(name)
  File "C:\Users\301002\AppData\Local\Programs\Python\Python313\Lib\importlib\__init__.py", line 88, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
  File "<frozen importlib._bootstrap>", line 1324, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'openpyxl'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\src\process_excel_order.py", line 54, in process_excel_file
    df = pd.read_excel(filepath, header=3)
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\io\excel\_base.py", line 481, in read_excel
    io = ExcelFile(
        io,
    ...<2 lines>...
        engine_kwargs=engine_kwargs,
    )
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\io\excel\_base.py", line 1621, in __init__
    self._reader = self._engines[engine](
                   ~~~~~~~~~~~~~~~~~~~~~^
        self._io,
        ^^^^^^^^^
        storage_options=storage_options,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        engine_kwargs=engine_kwargs,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\io\excel\_openpyxl.py", line 559, in __init__
    import_optional_dependency("openpyxl")
    ~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\venv\Lib\site-packages\pandas\compat\_optional.py", line 161, in import_optional_dependency
    raise ImportError(msg) from err
ImportError: `Import openpyxl` failed.  Use pip or conda to install the openpyxl package.
2026-02-11 15:30:55,753 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-11 15:30:56,840 - INFO - 正在讀取檔案: AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx
2026-02-11 15:31:02,610 - ERROR - 處理檔案 AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx 時發生錯誤: NDFrame.fillna() got an unexpected keyword argument 'method'
Traceback (most recent call last):
  File "G:\我的雲端硬碟\SeaExpress_Automation_Project\SeaExpress_Core\src\process_excel_order.py", line 70, in process_excel_file
    df['分提單號碼'] = df['分提單號碼'].fillna(method='ffill')
                       ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
TypeError: NDFrame.fillna() got an unexpected keyword argument 'method'
2026-02-11 15:37:20,960 - INFO - 掃描到 1 個檔案，開始作業...
2026-02-11 15:37:21,493 - INFO - 正在讀取檔案: AYLD25070901EX清关数据-长泰1210件7056.47KG （速龙派件）.xlsx
2026-02-11 15:37:25,188 - INFO - 解析完成，準備匯入 2562 筆資料...
2026-02-11 15:37:25,660 - INFO - 成功寫入資料庫！
2026-02-11 15:37:25,679 - INFO - 檔案已移至 processed 資料夾
